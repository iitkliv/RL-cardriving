(function(){var j,i,f,g,k=function(a,b){return function(){return a.apply(b,arguments)}};g=window.parent;f=g.document;i=null;j=window.usabilla_live.onEvent;var h=function(a,b,c,e,l){this.obj=a;this.property=b;this.off=c;this.on=e;this.defaultSpeed=l;this.doAnimation=k(this.doAnimation,this);this.callback=this.timer=this.goal=null};h.prototype.start=function(a,b){null==a&&(a=null);null==b&&(b=this.defaultSpeed);return this.animate(b,a,this.off,this.on)};h.prototype.stop=function(a,b){null==a&&(a=null);
null==b&&(b=this.defaultSpeed);return this.animate(b,a,this.on,this.off)};h.prototype.animate=function(a,b,c,e){"function"===typeof this.callback&&this.callback(!1);this.callback=b;this.startVal=b=parseInt(this.obj.style[this.property])||c;this.stopVal=e;this.speed=a*(1-(b-c)/(e-c));this.startTime=new Date;if(null===this.timer)return this.timer=setInterval(this.doAnimation,20)};h.prototype.doAnimation=function(){var a;a=Math.min(1,(new Date-this.startTime)/this.speed);a=(a-1)*(a-1)*(a-1)+1;this.obj.style[this.property]=
""+(this.startVal+(this.stopVal-this.startVal)*a)+"px";if(1<=a)return clearInterval(this.timer),this.timer=null,this.obj.style[this.property]=""+this.stopVal+"px","function"===typeof this.callback&&this.callback(!0),this.callback=null};var d=function(a,b,c){this.config=a;this.iframe=b;this.campaign=c;this.onMessage=k(this.onMessage,this);ensure_json();this.speed=this.config.speed||5E3;this.position=this.config.position||"right";this.offsetPercent=60;"positionOffset"in this.config&&(this.offsetPercent=
this.config.positionOffset);this.location=this.config.location+(-1===this.config.location.indexOf("?")?"?":"&")+"tags="+encodeURIComponent(this.position);"https:"!==f.location.protocol&&(this.location=this.location.replace(/^https:/,"http:"));this.stopOnFeedback=!0;this.startQueue=this.positioned=!1;this.animation=null;this.open=!1;this.opened=this.closed=this.property=null;i=f.getElementsByTagName("body")[0];this.initialize()};d.prototype.getTags=function(){return["slideout"]};d.prototype.initialize=
function(){var a,b,c,e=this;this.container=f.createElement("div");this.container.className="usabilla__overlay";b={position:"fixed",backgroundColor:"transparent",zIndex:"999999999",visibility:"hidden",margin:"0",padding:"0",overflow:"hidden",textAlign:"left"};b[this.position]="0";for(a in b)c=b[a],this.container.style[a]=c;this.msg=f.createElement("iframe");b={width:"10px",height:"10px",margin:"0",padding:"0",border:"0",overflow:"hidden",zIndex:"9997",maxWidth:"100%",position:"absolute",backgroundColor:"transparent",
visibility:"hidden",boxShadow:"0 0 0",display:"block"};for(a in b)c=b[a],this.msg.style[a]=c;this.msg.frameBorder="0";this.msg.marginWidth="0";this.msg.marginHeight="0";this.msg.scrolling="no";this.msg.allowTransparency=!0;this.msg.src=this.location;j(g,"message",function(a){a=a||window.event;if(!(null===e.msg||a.source!==e.msg.contentWindow))return ensure_json(function(){return e.onMessage(JSON.parse(a.data))})});this.container.appendChild(this.msg);return i.appendChild(this.container)};d.prototype.viewportWidth=
function(){return Math.max(f.documentElement.clientWidth,g.innerWidth||0)};d.prototype.viewportHeight=function(){var a;a=Math.max(f.documentElement.clientHeight,g.innerHeight||0);"BackCompat"===f.compatMode&&(0<g.innerHeight&&g.innerHeight<a)&&(a=g.innerHeight);return a};d.prototype.customData=function(){var a;return(null!=(a=window.usabilla_live_settings)?a.local_data:void 0)||{}};d.prototype.onMessage=function(a){if("resize"===a.type){if(this.size=a,this.reposition(),!this.positioned)return this.positionIframe(),
this.msg.contentWindow.postMessage(JSON.stringify({type:"url",url:f.location.toString()}),"*"),this.msg.contentWindow.postMessage(JSON.stringify({type:"customData",data:this.customData()}),"*")}else{if("stopOnFeedback"===a.type)return this.stopOnFeedback=!0;if("close"===a.type)return this.stop(),this.campaign.stop();if("feedback"===a.type)return this.stop(),this.campaign.boost=!0,window.usabilla_live.buttonClick();if("pageSwitch"===a.type)return this.campaign.pageSwitch(a);if("success"===a.type)return this.campaign.success({result:a.data||
null});if("successOnFeedback"===a.type)return this.campaign.successOnFeedback();if("failure"===a.type)return this.campaign.failure();if("markAsClicked"===a.type)return this.campaign.markAsClicked()}};d.prototype.adjustMobileFormPosition=function(a){var b;if(this.isMobile())return b=g.scrollY,this.container.style.position="absolute",this.container.style.top=""+(a+b)+"px"};d.prototype.reposition=function(){var a,b,c,e,d;c=0;d=this.size.width;a=this.size.height;if("bottom"===this.position||"top"===this.position)(e=
this.viewportWidth(),b=Math.round(e*(this.offsetPercent/100)),b-=d/2,0>b&&(b=0),b+d>e&&(b-=b+d-e),0>b&&(b=0,d=e),this.container.style.left=""+b+"px","bottom"===this.position)?(this.property="top",this.closed=a,this.opened=0,c=Math.max(0,this.viewportHeight()-a)):(this.property="top",this.closed=-a,this.opened=0);else if("right"===this.position||"left"===this.position)e=this.viewportHeight(),b=Math.round(e*(this.offsetPercent/100)),c=b-a/2,0>c&&(c=0),c+a>e&&(c-=c+a-e),0>c&&(c=0,this.isMobile()||(a=
e)),this.container.style.top=""+c+"px","right"===this.position?(this.property="left",this.closed=d):(this.property="left",this.closed=-d),this.opened=0;this.msg.style.width=""+d+"px";this.msg.style.height=""+a+"px";this.container.style.width=""+d+"px";this.container.style.height=""+a+"px";return this.adjustMobileFormPosition(c)};d.prototype.positionIframe=function(){this.msg.style[this.property]=this.closed;this.msg.style.visiblity="visible";this.container.style.visibility="visible";this.positioned=
!0;if(this.startQueue)return this.startQueue=!1,this.start()};d.prototype.start=function(){if(!this.open){if(this.positioned)return null===this.animation&&(this.animation=new h(this.msg,this.property,this.closed,this.opened,this.speed)),this.msg.style.visibility="visible",this.container.style.zIndex="9999999999",this.open=!0,this.animation.start();this.startQueue=!0}};d.prototype.stop=function(){var a=this;this.startQueue=!1;if(this.open&&(this.open=!1,null!==this.animation))return this.animation.stop(function(){a.animation=
null;return a.destroy()})};d.prototype.destroy=function(){var a=this;if(null!==this.msg&&(null!==this.animation&&this.animation.stop(function(){a.animation=null;return a.destroy()},0),this.container))return this.container.parentNode.removeChild(this.container),this.container=null};d.prototype.isMobile=function(){var a;a=!1;var b=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(b)||
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,
4)))a=!0;return a};RegisterScript("v2/slideout.coffee",d)}).call(this);
